from pwn import *

p = remote('47.254.76.121', 9999)

t1 = [b'POST /printers/rwctf HTTP/1.1\r\nContent-Length: 234\r\nContent-Type: application/ipp\r\nDate: Sun, 08 Jan 2023 04:40:15 GMT\r\nHost: localhost:631\r\nUser-Agent: CUPS/2.4.1 (Linux 5.15.0-52-generic; x86_64) IPP/2.0\r\nExpect: 100-continue\r\n\r\n', b'\x02\x00\x00\x0b\x00\x00\x00\x02\x01G\x00\x12attributes-charset\x00\x05utf-8H\x00\x1battributes-natural-language\x00\x05en-usE\x00\x0bprinter-uri\x00\x1eipp://localhost/printers/rwctfB\x00\x14requesting-user-name\x00\x04rootD\x00\x14requested-attributes\x00\x0cjob-templateD\x00\x00\x00\x12media-col-databaseD\x00\x00\x00\x13printer-description\x03', b'POST /printers/rwctf HTTP/1.1\r\nContent-Length: 171\r\nContent-Type: application/ipp\r\nDate: Sun, 08 Jan 2023 04:40:15 GMT\r\nHost: localhost:631\r\nUser-Agent: CUPS/2.4.1 (Linux 5.15.0-52-generic; x86_64) IPP/2.0\r\nExpect: 100-continue\r\n\r\n', b'\x02\x00\x00\x05\x00\x00\x00\x03\x01G\x00\x12attributes-charset\x00\x05utf-8H\x00\x1battributes-natural-language\x00\x05en-usE\x00\x0bprinter-uri\x00\x1eipp://localhost/printers/rwctfB\x00\x14requesting-user-name\x00\x04rootB\x00\x08job-name\x00\x08test.txt\x03', b'POST /printers/rwctf HTTP/1.1\r\nContent-Type: application/ipp\r\nDate: Sun, 08 Jan 2023 04:40:15 GMT\r\nHost: localhost:631\r\nTransfer-Encoding: chunked\r\nUser-Agent: CUPS/2.4.1 (Linux 5.15.0-52-generic; x86_64) IPP/2.0\r\nExpect: 100-continue\r\n\r\n', b'fe\r\n', b'\x02\x00\x00\x06\x00\x00\x00\x04\x01G\x00\x12attributes-charset\x00\x05utf-8H\x00\x1battributes-natural-language\x00\x05en-usE\x00\x0bprinter-uri\x00\x1eipp://localhost/printers/rwctf!\x00\x06job-id\x00\x04\x00\x00\x00\x15B\x00\x14requesting-user-name\x00\x04rootB\x00\rdocument-name\x00\x08test.txtI\x00\x0fdocument-format\x00\x18application/octet-stream"\x00\rlast-document\x00\x01\x01\x03', b'\r\n', b'5\r\n', b'test\n', b'\r\n', b'0\r\n\r\n']
t2 =  [b'HTTP/1.1 100 Continue\r\n\r\n', b"HTTP/1.1 200 OK\r\nConnection: Keep-Alive\r\nContent-Language: en_US\r\nContent-Length: 7529\r\nContent-Type: application/ipp\r\nDate: Sun, 08 Jan 2023 04:40:15 GMT\r\nKeep-Alive: timeout=10\r\nAccept-Encoding: gzip, deflate, identity\r\nServer: CUPS/2.4 IPP/2.1\r\nX-Frame-Options: DENY\r\nContent-Security-Policy: frame-ancestors 'none'\r\n\r\n", b'\x02\x00\x00\x00\x00\x00\x00\x02\x01G\x00\x12attributes-charset\x00\x05utf-8H\x00\x1battributes-natural-language\x00\x05en-us\x04!\x00\x12marker-change-time\x00\x04\x00\x00\x00\x001\x00\x1fprinter-config-change-date-time\x00\x0b\x07\xe7\x01\x07\x06)0\x00+\x00\x00!\x00\x1aprinter-config-change-time\x00\x04c\xb9\x14,1\x00\x14printer-current-time\x00\x0b\x07\xe7\x01\x08\x04(\x0f\x00+\x00\x00\x13\x00\x13printer-dns-sd-name\x00\x00E\x00\rprinter-icons\x00$http://localhost:631/icons/rwctf.png"\x00\x19printer-is-accepting-jobs\x00\x01\x01"\x00\x11printer-is-shared\x00\x01\x01"\x00\x14printer-is-temporary\x00\x01\x00E\x00\x11printer-more-info\x00#http://localhost:631/printers/rwctf#\x00\rprinter-state\x00\x04\x00\x00\x00\x041\x00\x1eprinter-state-change-date-time\x00\x0b\x07\xe7\x01\x08\x04&\x07\x00+\x00\x00!\x00\x19printer-state-change-time\x00\x04c\xbaH\xafA\x00\x15printer-state-message\x00#Unable to locate printer "printer".D\x00\x15printer-state-reasons\x00\x14connecting-to-device#\x00\x0cprinter-type\x00\x04\x00\x00\x00\x04!\x00\x0fprinter-up-time\x00\x04c\xbaI/E\x00\x15printer-uri-supported\x00"ipp://localhost:631/printers/rwctf!\x00\x10queued-job-count\x00\x04\x00\x00\x00\x03D\x00\x16uri-security-supported\x00\x04noneD\x00\x1curi-authentication-supported\x00\x14requesting-user-name!\x00\nprinter-id\x00\x04\x00\x00\x00\x01B\x00\x0cprinter-name\x00\x05rwctfA\x00\x10printer-location\x00\x00\x12\x00\x14printer-geo-location\x00\x00A\x00\x0cprinter-info\x00\x05rwctfA\x00\x14printer-organization\x00\x00A\x00\x1bprinter-organizational-unit\x00\x00E\x00\x0cprinter-uuid\x00-urn:uuid:54e85634-0371-3956-56f2-eb134e4c7d4b!\x00\x10job-quota-period\x00\x04\x00\x00\x00\x00!\x00\x0bjob-k-limit\x00\x04\x00\x00\x00\x00!\x00\x0ejob-page-limit\x00\x04\x00\x00\x00\x00B\x00\x12job-sheets-default\x00\x04noneB\x00\x00\x00\x04noneE\x00\ndevice-uri\x00 beh:/1/3/5/socket://printer:9100', b"I\x00\x19document-format-supported\x00\x12application/mswordI\x00\x00\x00\x18application/octet-streamI\x00\x00\x00\x10application/pclmI\x00\x00\x00\x0fapplication/pdfI\x00\x00\x00\x16application/postscriptI\x00\x00\x00\x13application/rss+xmlI\x00\x00\x00\x10application/sgmlI\x00\x00\x00'application/vnd.adobe-reader-postscriptI\x00\x00\x00\x1bapplication/vnd.cups-bannerI\x00\x00\x00\x18application/vnd.cups-brfI\x00\x00\x00\x1capplication/vnd.cups-commandI\x00\x00\x00\x1eapplication/vnd.cups-paged-brfI\x00\x00\x00\x1fapplication/vnd.cups-paged-ubrlI\x00\x00\x00\x18application/vnd.cups-pdfI\x00\x00\x00\x1fapplication/vnd.cups-pdf-bannerI\x00\x00\x00\x1fapplication/vnd.cups-postscriptI\x00\x00\x00\x18application/vnd.cups-ppdI\x00\x00\x00\x1bapplication/vnd.cups-rasterI\x00\x00\x00\x18application/vnd.cups-rawI\x00\x00\x00\x19application/vnd.cups-ubrlI\x00\x00\x00(application/vnd.oasis.opendocument.chartI\x00\x00\x00+application/vnd.oasis.opendocument.databaseI\x00\x00\x00*application/vnd.oasis.opendocument.formulaI\x00\x00\x00+application/vnd.oasis.opendocument.graphicsI\x00\x00\x004application/vnd.oasis.opendocument.graphics-templateI\x00\x00\x00(application/vnd.oasis.opendocument.imageI\x00\x00\x00/application/vnd.oasis.opendocument.presentationI\x00\x00\x008application/vnd.oasis.opendocument.presentation-templateI\x00\x00\x00.application/vnd.oasis.opendocument.spreadsheetI\x00\x00\x007application/vnd.oasis.opendocument.spreadsheet-templateI\x00\x00\x00'application/vnd.oasis.opendocument.textI\x00\x00\x00.application/vnd.oasis.opendocument.text-masterI\x00\x00\x000application/vnd.oasis.opendocument.text-templateI\x00\x00\x00+application/vnd.oasis.opendocument.text-webI\x00\x00\x00Iapplication/vnd.openxmlformats-officedocument.presentationml.presentationI\x00\x00\x00Bapplication/vnd.openxmlformats-officedocument.presentationml.slideI\x00\x00\x00Fapplication/vnd.openxmlformats-officedocument.presentationml.slideshowI\x00\x00\x00Eapplication/vnd.openxmlformats-officedocument.presentationml.templateI\x00\x00\x00Aapplication/vnd.openxmlformats-officedocument.spreadsheetml.sheetI\x00\x00\x00Dapplication/vnd.openxmlformats-officedocument.spreadsheetml.templateI\x00\x00\x00Gapplication/vnd.openxmlformats-officedocument.wordprocessingml.documentI\x00\x00\x00Gapplication/vnd.openxmlformats-officedocument.wordprocessingml.templateI\x00\x00\x00&application/vnd.recordare.musicxml+xmlI\x00\x00\x00\x14application/x-cshellI\x00\x00\x00\x15application/x-csourceI\x00\x00\x00\x12application/x-perlI\x00\x00\x00\x13application/x-shellI\x00\x00\x00\x12application/x-xfigI\x00\x00\x00\timage/cgmI\x00\x00\x00\timage/emfI\x00\x00\x00\timage/gifI\x00\x00\x00\nimage/jpegI\x00\x00\x00\timage/pngI\x00\x00\x00\x10image/pwg-rasterI\x00\x00\x00\rimage/svg+xmlI\x00\x00\x00\nimage/tiffI\x00\x00\x00\timage/urfI\x00\x00\x00\x12image/vnd.cups-brfI\x00\x00\x00\x12image/vnd.cups-pdfI\x00\x00\x00\x13image/vnd.cups-ubrlI\x00\x00\x00\timage/wmfI\x00\x00\x00\rimage/x-aliasI\x00\x00\x00\x0eimage/x-bitmapI\x00\x00\x00\x0bimage/x-cmxI\x00\x00\x00\x0cimage/x-iconI\x00\x00\x00\x0fimage/x-photocdI\x00\x00\x00\x17image/x-portable-anymapI\x00\x00\x00\x17image/x-portable-bitmapI\x00\x00\x00\x18image/x-portable-graymapI\x00\x00\x00\x17image/x-portable-pixmapI\x00\x00\x00\x0fimage/x-sgi-rgbI\x00\x00\x00\x12image/x-sun-rasterI\x00\x00\x00\x0fimage/x-xbitmapI\x00\x00\x00\x0fimage/x-xpixmapI\x00\x00\x00\x13image/x-xwindowdumpI\x00\x00\x00\x08text/cssI\x00\x00\x00\ttext/htmlI\x00\x00\x00\ntext/plain", b'!\x00\x0ecopies-default\x00\x04\x00\x00\x00\x01I\x00\x17document-format-default\x00\x18application/octet-streamD\x00\x16job-hold-until-default\x00\x07no-hold!\x00\x14job-priority-default\x00\x04\x00\x00\x002!\x00\x11number-up-default\x00\x04\x00\x00\x00\x01\x13\x00\x1dorientation-requested-default\x00\x00D\x00\x18print-color-mode-default\x00\nmonochrome#\x00\x15print-quality-default\x00\x04\x00\x00\x00\x04A\x00\x16printer-make-and-model\x00\x11Local Raw Printer#\x00\x14finishings-supported\x00\x04\x00\x00\x00\x03#\x00\x12finishings-default\x00\x04\x00\x00\x00\x03G\x00\x12charset-configured\x00\x05utf-8G\x00\x11charset-supported\x00\x08us-asciiG\x00\x00\x00\x05utf-8D\x00\x15compression-supported\x00\x04noneD\x00\x00\x00\x04gzip3\x00\x10copies-supported\x00\x08\x00\x00\x00\x01\x00\x00\'\x0fH\x00$generated-natural-language-supported\x00\x05en-usD\x00\x16ipp-features-supported\x00\x13subscription-objectD\x00\x16ipp-versions-supported\x00\x031.0D\x00\x00\x00\x031.1D\x00\x00\x00\x032.0D\x00\x00\x00\x032.1!\x00\x11ippget-event-life\x00\x04\x00\x00\x00\x0fD\x00!job-creation-attributes-supported\x00\x06copiesD\x00\x00\x00\nfinishingsD\x00\x00\x00\x0efinishings-colD\x00\x00\x00\x16ipp-attribute-fidelityD\x00\x00\x00\x0ejob-hold-untilD\x00\x00\x00\x08job-nameD\x00\x00\x00\x0cjob-priorityD\x00\x00\x00\njob-sheetsD\x00\x00\x00\x05mediaD\x00\x00\x00\tmedia-colD\x00\x00\x00\x1amultiple-document-handlingD\x00\x00\x00\tnumber-upD\x00\x00\x00\x10number-up-layoutD\x00\x00\x00\x15orientation-requestedD\x00\x00\x00\noutput-binD\x00\x00\x00\rpage-deliveryD\x00\x00\x00\x0bpage-rangesD\x00\x00\x00\x10print-color-modeD\x00\x00\x00\rprint-qualityD\x00\x00\x00\rprint-scalingD\x00\x00\x00\x12printer-resolutionD\x00\x00\x00\x05sidesD\x00\x18job-hold-until-supported\x00\x07no-holdD\x00\x00\x00\nindefiniteD\x00\x00\x00\x08day-timeD\x00\x00\x00\x07eveningD\x00\x00\x00\x05nightD\x00\x00\x00\x0csecond-shiftD\x00\x00\x00\x0bthird-shiftD\x00\x00\x00\x07weekend"\x00\x11job-ids-supported\x00\x01\x013\x00\x16job-k-octets-supported\x00\x08\x00\x00\x00\x00\x07\xcf\x00$!\x00\x16job-priority-supported\x00\x04\x00\x00\x00dD\x00!job-settable-attributes-supported\x00\x06copiesD\x00\x00\x00\nfinishingsD\x00\x00\x00\x0ejob-hold-untilD\x00\x00\x00\x08job-nameD\x00\x00\x00\x0cjob-priorityD\x00\x00\x00\x05mediaD\x00\x00\x00\tmedia-colD\x00\x00\x00\x1amultiple-document-handlingD\x00\x00\x00\tnumber-upD\x00\x00\x00\noutput-binD\x00\x00\x00\x15orientation-requestedD\x00\x00\x00\x0bpage-rangesD\x00\x00\x00\x10print-color-modeD\x00\x00\x00\rprint-qualityD\x00\x00\x00\x12printer-resolutionD\x00\x00\x00\x05sidesB\x00\x14job-sheets-supported\x00\x04noneB\x00\x00\x00\nclassifiedB\x00\x00\x00\x0cconfidentialB\x00\x00\x00\x04formB\x00\x00\x00\x06secretB\x00\x00\x00\x08standardB\x00\x00\x00\ttopsecretB\x00\x00\x00\x0cunclassified3\x00\x17jpeg-k-octets-supported\x00\x08\x00\x00\x00\x00\x07\xcf\x00$3\x00\x1ajpeg-x-dimension-supported\x00\x08\x00\x00\x00\x00\x00\x00\xff\xff3\x00\x1ajpeg-y-dimension-supported\x00\x08\x00\x00\x00\x01\x00\x00\xff\xffD\x00\x13media-col-supported\x00\x13media-bottom-marginD\x00\x00\x00\x11media-left-marginD\x00\x00\x00\x12media-right-marginD\x00\x00\x00\nmedia-sizeD\x00\x00\x00\x0cmedia-sourceD\x00\x00\x00\x10media-top-marginD\x00\x00\x00\nmedia-type', b'D\x00$multiple-document-handling-supported\x00$separate-documents-uncollated-copiesD\x00\x00\x00"separate-documents-collated-copies"\x00 multiple-document-jobs-supported\x00\x01\x01!\x00\x1bmultiple-operation-time-out\x00\x04\x00\x00\x03\x84D\x00"multiple-operation-time-out-action\x00\x0bprocess-jobH\x00\x1bnatural-language-configured\x00\x05en-us!\x00\x13number-up-supported\x00\x04\x00\x00\x00\x01!\x00\x00\x00\x04\x00\x00\x00\x02!\x00\x00\x00\x04\x00\x00\x00\x04!\x00\x00\x00\x04\x00\x00\x00\x06!\x00\x00\x00\x04\x00\x00\x00\t!\x00\x00\x00\x04\x00\x00\x00\x10#\x00\x14operations-supported\x00\x04\x00\x00\x00\x02#\x00\x00\x00\x04\x00\x00\x00\x04#\x00\x00\x00\x04\x00\x00\x00\x05#\x00\x00\x00\x04\x00\x00\x00\x06#\x00\x00\x00\x04\x00\x00\x00\x08#\x00\x00\x00\x04\x00\x00\x00\t#\x00\x00\x00\x04\x00\x00\x00\n#\x00\x00\x00\x04\x00\x00\x00\x0b#\x00\x00\x00\x04\x00\x00\x00\x0c#\x00\x00\x00\x04\x00\x00\x00\r#\x00\x00\x00\x04\x00\x00\x00\x10#\x00\x00\x00\x04\x00\x00\x00\x11#\x00\x00\x00\x04\x00\x00\x00\x12#\x00\x00\x00\x04\x00\x00\x00\x13#\x00\x00\x00\x04\x00\x00\x00\x14#\x00\x00\x00\x04\x00\x00\x00\x15#\x00\x00\x00\x04\x00\x00\x00\x16#\x00\x00\x00\x04\x00\x00\x00\x17#\x00\x00\x00\x04\x00\x00\x00\x18#\x00\x00\x00\x04\x00\x00\x00\x19#\x00\x00\x00\x04\x00\x00\x00\x1a#\x00\x00\x00\x04\x00\x00\x00\x1b#\x00\x00\x00\x04\x00\x00\x00\x1c#\x00\x00\x00\x04\x00\x00\x00"#\x00\x00\x00\x04\x00\x00\x00##\x00\x00\x00\x04\x00\x00\x00%#\x00\x00\x00\x04\x00\x00\x00&#\x00\x00\x00\x04\x00\x00\x008#\x00\x00\x00\x04\x00\x00\x009#\x00\x00\x00\x04\x00\x00\x00;#\x00\x00\x00\x04\x00\x00@\x01#\x00\x00\x00\x04\x00\x00@\x02#\x00\x00\x00\x04\x00\x00@\x03#\x00\x00\x00\x04\x00\x00@\x04#\x00\x00\x00\x04\x00\x00@\x05#\x00\x00\x00\x04\x00\x00@\x06#\x00\x00\x00\x04\x00\x00@\x07#\x00\x00\x00\x04\x00\x00@\x08#\x00\x00\x00\x04\x00\x00@\t#\x00\x00\x00\x04\x00\x00@\n#\x00\x00\x00\x04\x00\x00@\x0b#\x00\x00\x00\x04\x00\x00@\x0c#\x00\x00\x00\x04\x00\x00@\r#\x00\x00\x00\x04\x00\x00@\x0e#\x00\x00\x00\x04\x00\x00@\x0f#\x00\x00\x00\x04\x00\x00@\'#\x00\x00\x00\x04\x00\x00\x00\x0e#\x00\x1forientation-requested-supported\x00\x04\x00\x00\x00\x03#\x00\x00\x00\x04\x00\x00\x00\x04#\x00\x00\x00\x04\x00\x00\x00\x05#\x00\x00\x00\x04\x00\x00\x00\x06D\x00\x17page-delivery-supported\x00\rreverse-orderD\x00\x00\x00\nsame-order"\x00\x15page-ranges-supported\x00\x01\x013\x00\x16pdf-k-octets-supported\x00\x08\x00\x00\x00\x00\x07\xcf\x00$D\x00\x16pdf-versions-supported\x00\tadobe-1.2D\x00\x00\x00\tadobe-1.3D\x00\x00\x00\tadobe-1.4D\x00\x00\x00\tadobe-1.5D\x00\x00\x00\tadobe-1.6D\x00\x00\x00\tadobe-1.7D\x00\x00\x00\x10iso-19005-1_2005D\x00\x00\x00\x10iso-32000-1_2008D\x00\x00\x00\npwg-5102.3D\x00\x16pdl-override-supported\x00\tattemptedD\x00\x17print-scaling-supported\x00\x04autoD\x00\x00\x00\x08auto-fitD\x00\x00\x00\x04fillD\x00\x00\x00\x03fitD\x00\x00\x00\x04noneD\x00 printer-get-attributes-supported\x00\x0fdocument-formatD\x00%printer-settable-attributes-supported\x00\x14printer-geo-locationD\x00\x00\x00\x0cprinter-infoD\x00\x00\x00\x10printer-locationD\x00\x00\x00\x14printer-organizationD\x00\x00\x00\x1bprinter-organizational-unitD\x00\x14which-jobs-supported\x00\tcompletedD\x00\x00\x00\rnot-completedD\x00\x00\x00\x07abortedD\x00\x00\x00\x03allD\x00\x00\x00\x08canceledD\x00\x00\x00\x07pendingD\x00\x00\x00\x0cpending-heldD\x00\x00\x00\nprocessingD\x00\x00\x00\x12processing-stopped\x03', b'HTTP/1.1 100 Continue\r\n\r\n', b"HTTP/1.1 200 OK\r\nConnection: Keep-Alive\r\nContent-Language: en_US\r\nContent-Length: 204\r\nContent-Type: application/ipp\r\nDate: Sun, 08 Jan 2023 04:40:15 GMT\r\nKeep-Alive: timeout=10\r\nAccept-Encoding: gzip, deflate, identity\r\nServer: CUPS/2.4 IPP/2.1\r\nX-Frame-Options: DENY\r\nContent-Security-Policy: frame-ancestors 'none'\r\n\r\n", b'\x02\x00\x00\x00\x00\x00\x00\x03\x01G\x00\x12attributes-charset\x00\x05utf-8H\x00\x1battributes-natural-language\x00\x05en-us\x02E\x00\x07job-uri\x00\x1bipp://localhost:631/jobs/21!\x00\x06job-id\x00\x04\x00\x00\x00\x15#\x00\tjob-state\x00\x04\x00\x00\x00\x04A\x00\x11job-state-message\x00\x00D\x00\x11job-state-reasons\x00\x0cjob-incoming\x03', b'HTTP/1.1 100 Continue\r\n\r\n', b"HTTP/1.1 200 OK\r\nConnection: Keep-Alive\r\nContent-Language: en_US\r\nContent-Length: 174\r\nContent-Type: application/ipp\r\nDate: Sun, 08 Jan 2023 04:40:15 GMT\r\nKeep-Alive: timeout=10\r\nAccept-Encoding: gzip, deflate, identity\r\nServer: CUPS/2.4 IPP/2.1\r\nX-Frame-Options: DENY\r\nContent-Security-Policy: frame-ancestors 'none'\r\n\r\n", b'\x02\x00\x00\x00\x00\x00\x00\x04\x01G\x00\x12attributes-charset\x00\x05utf-8H\x00\x1battributes-natural-language\x00\x05en-us\x02E\x00\x07job-uri\x00\x1bipp://localhost:631/jobs/21!\x00\x06job-id\x00\x04\x00\x00\x00\x15#\x00\tjob-state\x00\x04\x00\x00\x00\x03D\x00\x11job-state-reasons\x00\x04none\x03']

p.interactive()